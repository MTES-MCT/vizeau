import Exploitation from '#models/exploitation'
import Contact from '#models/contact'
import { ModelAttributes } from '@adonisjs/lucid/types/model'

export class ExploitationService {
  /**
   * Create an exploitation with an optional contact.
   * If contactData is provided and contains a name, a contact will be created and associated with the exploitation.
   */
  async createExploitationWithContact(
    exploitationData: Partial<ModelAttributes<Exploitation>>,
    contactData?: Partial<ModelAttributes<Contact>>
  ) {
    const exploitation = await Exploitation.create(exploitationData)

    if (contactData?.name) {
      await exploitation.related('contacts').create(contactData)
    }

    return exploitation
  }
}
