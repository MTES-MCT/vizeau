import factory from '@adonisjs/lucid/factories'
import Exploitation, { ExploitationTypeStructure } from '#models/exploitation'
import { ContactFactory } from '#database/factories/contact_factory'
import { ExploitationTagFactory } from '#database/factories/exploitation_tag_factory'

export const ExploitationFactory = factory
  .define(Exploitation, async ({ faker }) => {
    return {
      name: faker.company.name(),
      typeStructure: faker.helpers.objectValue(ExploitationTypeStructure),
      siret: faker.string.numeric(14),
      addressLine1: faker.location.streetAddress(),
      addressLine2: faker.location.secondaryAddress(),
      postalCode: faker.location.zipCode(),
      commune: faker.location.city(),
      location: `(${faker.location.longitude()},${faker.location.latitude()})`,
    }
  })
  .relation('contacts', () => ContactFactory)
  .relation('tags', () => ExploitationTagFactory) // No tags by default
  .build()
