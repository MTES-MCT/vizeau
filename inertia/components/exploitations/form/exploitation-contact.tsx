import { Alert } from '@codegouvfr/react-dsfr/Alert'
import Input from '@codegouvfr/react-dsfr/Input'

import SectionCard from '~/ui/SectionCard'
import { ExploitationFormValues } from '~/components/exploitations/form/exploitation-form'
import { SetDataAction } from '@inertiajs/react'

export default function exploitationContact({
  exploitation,
  setExploitation,
  error,
  setError,
}: {
  exploitation: ExploitationFormValues
  setExploitation: SetDataAction<ExploitationFormValues>
  error?: any
  setError?: (value: any) => void
}) {
  return (
    <div>
      <SectionCard title="Contact" icon="fr-icon-user-star-line" background="secondary">
        <Alert
          description="Optionnel, mais recommandé : Ajouter un contact permet de simplifier les échanges et d’identifier facilement l’interlocuteur principal."
          severity="info"
          small
        />
        <div className="fr-grid-row">
          <Input
            label="Prénom"
            className="fr-col-6 fr-mt-4w fr-p-1w"
            nativeInputProps={{
              placeholder: 'Entrer le prénom du contact',
              defaultValue: exploitation?.contacts?.[0]?.firstName || '',
              onChange: (e) => setExploitation('contacts.0.firstName', e.target.value),
            }}
          />
          <Input
            label="Nom"
            className="fr-col-6 fr-mt-4w fr-p-1w"
            nativeInputProps={{
              placeholder: 'Entrer le nom du contact',
              defaultValue: exploitation?.contacts?.[0]?.lastName || '',
              onChange: (e) => setExploitation('contacts.0.lastName', e.target.value),
            }}
          />
        </div>
        <div>
          <Input
            label="Rôle"
            hintText="Exploitant(e), conjoint(e), enfant de la personne exploitante, parent de la personne exploitante, comptable"
            className="fr-p-1w"
            nativeInputProps={{
              placeholder: 'Entrer le rôle du contact',
              defaultValue: exploitation?.contacts?.[0]?.role || '',
              onChange: (e) => setExploitation('contacts.0.role', e.target.value),
            }}
          />
        </div>
        <div className="flex justify-between">
          <Input
            label="E-mail"
            className="fr-mt-4w fr-p-1w w-1/2 fr-m-1w"
            state={error?.contactEmail && 'error'}
            stateRelatedMessage="L’adresse e-mail n’est pas valide."
            nativeInputProps={{
              type: 'email',
              placeholder: 'Entrer l’adresse e-mail du contact',
              defaultValue: exploitation?.contacts?.[0]?.email || '',
              onChange: (e) => {
                const { contactEmail, ...rest } = error || {}
                setError?.(rest)
                setExploitation('contacts.0.email', e.target.value)
              },
            }}
          />
          <Input
            label="Téléphone"
            className="fr-mt-4w fr-p-1w w-1/2 fr-m-1w"
            state={error?.contactPhoneNumber && 'error'}
            stateRelatedMessage="Le numéro de téléphone n’est pas valide."
            nativeInputProps={{
              type: 'tel',
              placeholder: 'Entrer le numéro de téléphone du contact',
              defaultValue: exploitation?.contacts?.[0]?.phoneNumber || '',
              onChange: (e) => {
                const { contactPhoneNumber, ...rest } = error || {}
                setError?.(rest)
                setExploitation('contacts.0.phoneNumber', e.target.value)
              },
            }}
          />
        </div>
      </SectionCard>
    </div>
  )
}
