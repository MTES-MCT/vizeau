import { Input } from '@codegouvfr/react-dsfr/Input'
import SectionCard from '~/ui/SectionCard'
import { TagSelector } from '~/components/exploitation-id/TagSelector'

type EntryLogFormProps = {
  data: {
    id?: string
    notes: string
    tags: number[]
  }
  setData: (field: 'notes' | 'tags', value: any) => void
  inputValue: string
  setInputValue: (val: string) => void
  disabled?: boolean
}

export function EntryLogForm({
  data,
  setData,
  inputValue,
  setInputValue,
  disabled = false,
}: EntryLogFormProps) {
  return (
    <>
      {!disabled ? (
        <Input
          textArea
          label="Note"
          nativeTextAreaProps={{
            name: 'notes',
            maxLength: 1000,
            value: data.notes,
            onChange: (e) => setData('notes', e.target.value),
            readOnly: disabled,
          }}
        />
      ) : (
        <>
          <h2 className="fr-label fr-mb-1w">Note</h2>
          <p>{data.notes}</p>
        </>
      )}
      <div className="fr-pb-15w">
        <SectionCard
          size="small"
          background="secondary"
          icon="fr-icon-star-line"
          title="Ã‰tiquettes"
        >
          <TagSelector
            inputValue={inputValue}
            setInputValue={setInputValue}
            logEntryId={data.id}
            values={data.tags}
            onChange={(tags) => setData('tags', tags)}
            disabled={disabled}
          />
        </SectionCard>
      </div>
    </>
  )
}
