import { fr } from '@codegouvfr/react-dsfr'
import Tooltip from '@codegouvfr/react-dsfr/Tooltip'
import type { ExploitationJson } from '../../types/models.ts'
import LabelInfo from '~/ui/LabelInfo/index.js'
import SmallSection from '~/ui/SmallSection/index.js'
import { displayContactName, getMainContact } from '~/functions/contacts.js'

export default function VisualisationExploitationInfos({
  exploitation,
}: {
  exploitation: ExploitationJson
}) {
  const mainContact = getMainContact(exploitation.contacts ?? undefined)

  return (
    <SmallSection
      title="Informations générales"
      iconId="fr-icon-pass-pending-line"
      priority="secondary"
      hasBorder
    >
      <div className="flex flex-col gap-2">
        <LabelInfo
          label="Dénomination"
          size="sm"
          info={exploitation?.denominationLegale || 'N/A'}
        />
        <LabelInfo label="SIRET" size="sm" info={exploitation?.siret || 'N/A'} />
        <LabelInfo
          label="Activité principale (NAF / APE)"
          size="sm"
          info={exploitation?.activite || 'N/A'}
        />
        <LabelInfo label="Forme juridique" size="sm" info={exploitation?.formeJuridique || 'N/A'} />
        <LabelInfo
          label="Adresse"
          size="sm"
          info={
            (exploitation?.addressLine1 || '') +
            ' ' +
            (exploitation?.commune || '') +
            ' ' +
            (exploitation?.postalCode || '')
          }
        />

        <LabelInfo
          label="Contact principal"
          size="sm"
          info={
            <>
              {displayContactName(mainContact)}
              {(mainContact?.firstName || mainContact?.lastName) && (
                <span className="fr-pl-1w">
                  <Tooltip
                    title={
                      <div>
                        <div>
                          <span
                            className="fr-icon-user-line fr-icon--sm fr-pr-1w"
                            style={{
                              color: fr.colors.decisions.text.actionHigh.blueFrance.default,
                            }}
                          />
                          {mainContact?.role || 'Non renseigné'}
                        </div>
                        <div>
                          <span
                            className="fr-icon-mail-line fr-icon--sm fr-pr-1w"
                            style={{
                              color: fr.colors.decisions.text.actionHigh.blueFrance.default,
                            }}
                          />
                          {mainContact?.email || 'Non renseigné'}
                        </div>
                      </div>
                    }
                  />
                </span>
              )}
            </>
          }
        />
      </div>
    </SmallSection>
  )
}
